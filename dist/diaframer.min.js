/*! diaframer - v0.0.0 - 2015-08-26 copyright by Sascha HÃ¤usler */ 
(function(){var a,b,c,d,e,f,g,h,i,j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;c=function(){function a(a){this.canvas=new b(a),this.uml=null,this.example=null}return a.prototype.getUmlDrawer=function(){return null!=this.uml?this.uml:(this.uml=new i(this.canvas),this.uml)},a.prototype.getExampleDrawer=function(){return null!=this.example?this.example:(this.example=new e(this.canvas),this.example)},a}(),window.Diaframer=c,a=function(){function a(a){this.canvas=a}return a}(),e=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.draw_cross=function(){var a,b;return a=new f(this.canvas,{start_point:new g(20,20),end_point:new g(300,300)}),b=new f(this.canvas,{start_point:new g(20,300),end_point:new g(300,20)}),this.canvas.add_object(a),this.canvas.add_object(b),this.canvas.render_all()},b.prototype.draw_two_connected_boxes=function(){var a,b;return a=new h(this.canvas),a.set("left_corner",new g(20,20)),a.set("width",300),a.set("height",200),b=new h(this.canvas),b.set("left_corner",new g(480,170)),b.set("width",300),b.set("height",200),this.canvas.add_object(a),this.canvas.add_object(b),this.canvas.render_all(),this.canvas.connect(a,b)},b}(a),i=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return j(b,a),b}(a),g=function(){function a(a,b){this.x=a,this.y=b}return a}(),b=function(){function a(a){this.canvas=a,this.context=this.canvas.getContext("2d"),this._objects=[]}return a.prototype.add_object=function(a){return this._objects.push(a)},a.prototype.render_all=function(){var a,b,c,d,e;for(d=this._objects,e=[],a=0,b=d.length;b>a;a++)c=d[a],e.push(c.draw());return e},a.prototype.draw_line=function(a,b){return this.context.beginPath(),this.context.moveTo(a.x,a.y),this.context.lineTo(b.x,b.y),this.context.stroke()},a.prototype.draw_vertical_line=function(a,b){return this.draw_line(a,new g(a.x,a.y+b))},a.prototype.draw_horizontal_line=function(a,b){return this.draw_line(a,new g(a.x+b,a.y))},a.prototype.draw_rectangle=function(a,b,c){return this.context.beginPath(),this.context.rect(a.x,a.y,b,c),this.context.stroke()},a.prototype.connect=function(a,b){var c,d,e;return c=a.get_connection_points(),d=b.get_connection_points(),e=this.find_nearest_points(c,d),this.draw_line.apply(this,e)},a.prototype.find_nearest_points=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;for(i=1e6,j=[],a.length>=1&&b.length>=1&&(n=Math.abs(a[0].x-b[0].x),o=Math.abs(a[0].y-b[0].y),d=n>o,e=o>n),c=0,g=a.length;g>c;c++)for(k=a[c],f=0,h=b.length;h>f;f++)l=b[f],n=Math.abs(k.x-l.x),o=Math.abs(k.y-l.y),m=d?n:e?o:n+o,i>m&&(i=m,j=[k,l]);return j},a}(),d=function(){function a(a){var b,c,d,e,f,g;for(this.canvas=a,this.data={},f=Array.prototype.slice.call(arguments,1),c=0,e=f.length;e>c;c++)if(b=f[c],"object"==typeof b)for(d in b)g=b[d],this.set(d,g)}return a.prototype.get=function(a){return this.data[a]},a.prototype.set=function(a,b){return this.data[a]=b},a.prototype.get_connection_points=function(){throw new Error("This method has to be implemented")},a.prototype.draw=function(){throw new Error("This method has to be implemented")},a}(),f=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.draw=function(){return this.canvas.draw_line(this.get("start_point"),this.get("end_point"))},b}(d),h=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.get_connection_points=function(){var a,b,c,d,e,f,h,i;return b=[],d=this.get("left_corner"),e=d.x+this.get("width")/2,i=new g(e,d.y),b.push(i),f=d.y+this.get("height")/2,h=new g(d.x+this.get("width"),f),b.push(h),a=new g(e,d.y+this.get("height")),b.push(a),c=new g(d.x,f),b.push(c),b},b.prototype.draw=function(){return this.canvas.draw_rectangle(this.get("left_corner"),this.get("width"),this.get("height"))},b}(d)}).call(this);